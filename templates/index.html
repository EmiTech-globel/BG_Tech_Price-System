<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CNC/Laser Cutting Price Quote System</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="body-container">
    <div class="container">
    <div class="header">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="BrainGain Tech" class="header-logo">
        <h1>CNC/Laser Cutting Price Quote</h1>
        <p>BrainGain Tech Innovation Solutions</p>
    </div>

        <div class="tabs">
            <div class="tab active" onclick="showTab('upload')">
                üì§ Upload Design
            </div>
            <div class="tab" onclick="showTab('manual')">
                ‚úçÔ∏è Manual Entry
            </div>
            <div class="tab" onclick="showTab('bulk')">
                üì¶ Bulk Order
            </div>
        </div>

        <div class="content">
            <!-- UPLOAD TAB -->
            <div id="upload" class="tab-content active">
                <div class="info-box">
                    <strong>üìã How it works:</strong> Upload your DXF or SVG file and we'll automatically extract dimensions, shapes, and complexity. You just need to specify material and thickness!
                </div>
                
                <div class="upload-area" id="uploadArea">
                   <div class="upload-icon">üìÅ</div>
                   <h2>Drop your DXF or SVG file here</h2>
                   <p style="margin-top: 10px; opacity: 0.7;">or click to browse</p>
                   <p style="margin-top: 5px; font-size: 0.9em; opacity: 0.6;">
                       Supports: DXF (recommended) and SVG files
                   </p>
                   <input type="file" id="fileInput" accept=".dxf,.svg" style="display: none;">
               </div>
                
                <div class="loading" id="uploadLoading">
                    <div class="spinner"></div>
                    <p style="margin-top: 15px;">Analyzing file...</p>
                </div>
                
                <div class="file-info" id="fileInfo">
                    <h3>üìê Extracted Information:</h3>
                    <div style="margin-top: 15px;">
                        <div class="detail-row">
                            <span>Width:</span>
                            <strong id="extractedWidth">-</strong>
                        </div>
                        <div class="detail-row">
                            <span>Height:</span>
                            <strong id="extractedHeight">-</strong>
                        </div>
                        <div class="detail-row">
                            <span>Shapes:</span>
                            <strong id="extractedShapes">-</strong>
                        </div>
                        <div class="detail-row">
                            <span>Letters:</span>
                            <strong id="extractedLetters">-</strong>
                        </div>
                        <div class="detail-row">
                            <span>Complexity:</span>
                            <strong id="extractedComplexity">-</strong>
                        </div>
                        <div class="detail-row">
                            <span>Estimated Time:</span>
                            <strong id="extractedTime">-</strong>
                        </div>
                    </div>
                </div>
                
                <div class="row" style="margin-top: 20px;">
                    <div class="form-group">
                        <label>Material *</label>
                        <select id="uploadMaterial" onchange="loadColorsForMaterial('upload')">
                            <option value="">Select material...</option>
                            <option value="Acrylic">Acrylic</option>
                            <option value="Wood">Wood</option>
                            <option value="Metal">Metal</option>
                            <option value="MDF">MDF</option>
                            <option value="Plywood">Plywood</option>
                            <option value="Foam">Foam</option>
                            <option value="Cardboard">Cardboard</option>
                            <option value="ACP">ACP (Aluminium Composite Panel)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Thickness (mm) *</label>
                        <select id="uploadThickness" onchange="loadColorsForMaterial('upload')">
                            <option value="">Select thickness...</option>
                            <option value="1.5">1.5mm</option>
                            <option value="3">3mm</option>
                            <option value="4">4mm</option>
                            <option value="6">6mm</option>
                            <option value="9">9mm</option>
                            <option value="12">12mm</option>
                            <option value="15">15mm</option>
                            <option value="18">18mm</option>
                            <option value="25">25mm</option>
                        </select>
                    </div>
                </div>
                
                <div class="row" style="margin-top: 10px;">
                    <div class="form-group">
                        <label>Color *</label>
                        <select id="uploadColor">
                            <option value="">Select material and thickness first...</option>
                        </select>
                        <small id="uploadColorHelp" style="display: block; margin-top: 5px; color: #666;"></small>
                    </div>
                    
                    <div class="form-group">
                        <label>Cutting Type</label>
                        <select id="uploadCuttingType">
                            <option value="Laser Cutting">Laser Cutting</option>
                            <option value="CNC Router">CNC Router</option>
                        </select>
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label>Quantity</label>
                        <input type="number" id="uploadQuantity" value="1" min="1">
                    </div>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="uploadRush">
                    <label for="uploadRush" style="margin: 0;">Rush Job (Priority Processing)</label>
                </div>
                
                <button class="btn" id="uploadCalcBtn" onclick="calculateFromUpload()" disabled>Get Price Quote</button>
            </div>
            
            <!-- MANUAL TAB -->
            <div id="manual" class="tab-content">
                <div class="row">
                    <div class="form-group">
                        <label>Material *</label>
                        <select id="material" onchange="loadColorsForMaterial('manual')">
                            <option value="">Select material...</option>
                            <option value="Acrylic">Acrylic</option>
                            <option value="Wood">Wood</option>
                            <option value="Metal">Metal</option>
                            <option value="MDF">MDF</option>
                            <option value="Plywood">Plywood</option>
                            <option value="Foam">Foam</option>
                            <option value="Cardboard">Cardboard</option>
                            <option value="ACP">ACP (Aluminium Composite Panel)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Thickness (mm) *</label>
                        <input type="number" id="thickness" placeholder="e.g., 6" step="0.1" onchange="loadColorsForMaterial('manual')">
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label>Color *</label>
                        <select id="manualColor">
                            <option value="">Select material and thickness first...</option>
                        </select>
                        <small id="manualColorHelp" style="display: block; margin-top: 5px; color: #666;"></small>
                    </div>
                    
                    <div class="form-group">
                        <label>Width (mm) *</label>
                        <input type="number" id="width" placeholder="e.g., 500">
                    </div>
                </div>

                <div class="row">
                    <div class="form-group">
                        <label>Height (mm) *</label>
                        <input type="number" id="height" placeholder="e.g., 300">
                    </div>

                    <div class="form-group">
                        <label>Number of Letters</label>
                        <input type="number" id="letters" value="0" min="0">
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label>Number of Shapes</label>
                        <input type="number" id="shapes" value="1" min="1">
                    </div>

                    <div class="form-group">
                        <label>Complexity (1-5)</label>
                        <select id="complexity">
                            <option value="1">1 - Very Simple</option>
                            <option value="2">2 - Simple</option>
                            <option value="3" selected>3 - Moderate</option>
                            <option value="4">4 - Complex</option>
                            <option value="5">5 - Very Complex</option>
                        </select>
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label>Cutting Time (minutes) *</label>
                        <input type="number" id="time" placeholder="e.g., 30" step="0.1">
                    </div>

                    <div class="form-group">
                        <label>Cutting Type</label>
                        <select id="cuttingType">
                            <option value="Laser Cutting">Laser Cutting</option>
                            <option value="CNC Router">CNC Router</option>
                        </select>
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label>Quantity</label>
                        <input type="number" id="quantity" value="1" min="1">
                    </div>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="details">
                    <label for="details" style="margin: 0;">Has intricate details</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="rush">
                    <label for="rush" style="margin: 0;">Rush Job</label>
                </div>
                
                <button class="btn" onclick="calculatePrice()">Calculate Price</button>
            </div>

            <!-- BULK ORDER TAB -->
         <div id="bulk" class="tab-content">
            <div class="info-box">
                <strong>üì¶ Bulk Order:</strong> Add multiple items to a single quote or upload DXF files with multiple jobs.
            </div>
            
            <!-- Current Items List -->
            <div id="bulkItemsList" style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px;">Items in Current Order (<span id="itemCount">0</span>)</h3>
                <div id="itemsContainer">
                    <div class="empty-state">No items added yet. Add your first item below or upload a multi-job DXF file!</div>
                </div>
                <div id="bulkTotal" style="display: none;">
                    <div style="background: #FFF8F0; padding: 25px; border-radius: 12px; margin-top: 20px; border: 2px solid #E89D3C;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="font-size: 1.3em; font-weight: bold;">Grand Total</div>
                            <div style="font-size: 2em; font-weight: bold; color: #E89D3C;" id="grandTotal">‚Ç¶0.00</div>
                        </div>
                        <button class="btn" onclick="saveBulkQuote()" style="margin-top: 20px;">
                            üíæ Save Complete Order
                        </button>
                    </div>
                </div>
            </div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid #e0e0e0;">
                    
                    <h3 style="margin-bottom: 20px;">‚ûï Add New Item to Order</h3>
                    
                    <div class="form-group">
                        <label>Item Name/Description</label>
                        <input type="text" id="bulkItemName" placeholder="e.g., Company Logo Sign, Door Plate, etc.">
                    </div>
                    
                    <div class="row">
                        <div class="form-group">
                            <label>Material *</label>
                            <select id="bulkMaterial" onchange="loadColorsForMaterial('bulk')">
                                <option value="">Select material...</option>
                                <option value="Acrylic">Acrylic</option>
                                <option value="Wood">Wood</option>
                                <option value="Metal">Metal</option>
                                <option value="MDF">MDF</option>
                                <option value="Plywood">Plywood</option>
                                <option value="Foam">Foam</option>
                                <option value="Cardboard">Cardboard</option>
                                <option value="ACP">ACP</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Thickness (mm) *</label>
                            <input type="number" id="bulkThickness" placeholder="e.g., 6" step="0.1" onchange="loadColorsForMaterial('bulk')">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="form-group">
                            <label>Color *</label>
                            <select id="bulkColor">
                                <option value="">Select material and thickness first...</option>
                            </select>
                            <small id="bulkColorHelp" style="display: block; margin-top: 5px; color: #666;"></small>
                        </div>
                        
                        <div class="form-group">
                            <label>Width (mm) *</label>
                            <input type="number" id="bulkWidth" placeholder="e.g., 500">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="form-group">
                            <label>Height (mm) *</label>
                            <input type="number" id="bulkHeight" placeholder="e.g., 300">
                        </div>

                        <div class="form-group">
                            <label>Number of Letters</label>
                            <input type="number" id="bulkLetters" value="0" min="0">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="form-group">
                            <label>Number of Shapes</label>
                            <input type="number" id="bulkShapes" value="1" min="1">
                        </div>

                        <div class="form-group">
                            <label>Complexity (1-5)</label>
                            <select id="bulkComplexity">
                                <option value="1">1 - Very Simple</option>
                                <option value="2">2 - Simple</option>
                                <option value="3" selected>3 - Moderate</option>
                                <option value="4">4 - Complex</option>
                                <option value="5">5 - Very Complex</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="form-group">
                            <label>Cutting Time (minutes) *</label>
                            <input type="number" id="bulkTime" placeholder="e.g., 30" step="0.1">
                        </div>

                        <div class="form-group">
                            <label>Cutting Type</label>
                            <select id="bulkCuttingType">
                                <option value="Laser Cutting">Laser Cutting</option>
                                <option value="CNC Router">CNC Router</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="form-group">
                            <label>Quantity</label>
                            <input type="number" id="bulkQuantity" value="1" min="1">
                        </div>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="bulkDetails">
                        <label for="bulkDetails" style="margin: 0;">Has intricate details</label>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="bulkRush">
                        <label for="bulkRush" style="margin: 0;">‚ö° Rush Job</label>
                    </div>
                    
                    <button class="btn" onclick="addItemToBulk()">‚ûï Add Item & Calculate Price</button>
                </div>
        </div>

        <!-- RESULT BOX -->
        <div class="result-box" id="resultBox">
            <h2 style="text-align: center;">Price Quote</h2>
            <div class="price" id="priceDisplay">‚Ç¶0.00</div>
            
            <div class="details">
                <h3 style="margin-bottom: 15px;">Job Details:</h3>
                <div class="detail-row">
                    <span>Material:</span>
                    <strong id="resultMaterial">-</strong>
                </div>
                <div class="detail-row">
                    <span>Size:</span>
                    <strong id="resultSize">-</strong>
                </div>
                <div class="detail-row">
                    <span>Complexity:</span>
                    <strong id="resultComplexity">-</strong>
                </div>
                <div class="detail-row">
                    <span>Cutting Type:</span>
                    <strong id="resultCutting">-</strong>
                </div>
                <div class="detail-row">
                    <span>Quantity:</span>
                    <strong id="resultQuantity">-</strong>
                </div>
                <div class="detail-row">
                    <span>Estimated Time:</span>
                    <strong id="resultTime">-</strong>
                </div>
            </div>
            
            <!-- Customer Info Form (Hidden by default) -->
            <div id="customerForm" style="display: none; margin-top: 20px;">
                <div style="background: rgba(255,255,255,0.3); padding: 20px; border-radius: 10px;">
                    <h3 style="margin-bottom: 15px;">üíæ Save This Quote</h3>
                    <div style="margin-bottom: 15px;">
                        <input type="text" id="customerName" placeholder="Customer Name (Optional)" style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <input type="email" id="customerEmail" placeholder="Customer Email (Optional)" style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <input type="tel" id="customerPhone" placeholder="Customer Phone (Optional)" style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <input type="tel" id="customerWhatsApp" placeholder="Customer WhatsApp Number (Optional - e.g., +234XXXXXXXXXX)" style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <textarea id="quoteNotes" placeholder="Notes (Optional)" style="width: 100%; padding: 10px; border: none; border-radius: 5px; min-height: 60px;"></textarea>
                    </div>
                    <button onclick="saveCurrentQuote()" style="background: white; color: #667eea; padding: 12px 30px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%;">
                        Save Quote
                    </button>
                </div>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button onclick="toggleCustomerForm()" id="saveQuoteBtn" style="background: rgba(255,255,255,0.3); color: white; padding: 12px 30px; border: 2px solid white; border-radius: 8px; font-weight: 600; cursor: pointer;">
                    Save This Quote
                </button>
            </div>
            <div style="text-align: center; margin-top: 15px; display: flex; gap: 10px; justify-content: center;">
               <button onclick="shareCurrentQuoteOnWhatsApp()" style="background: #25D366; color: white; padding: 12px 30px; border: 2px solid white; border-radius: 8px; font-weight: 600; cursor: pointer; flex: 1; max-width: 200px;">
                   üìé Share PDF on WhatsApp
               </button>
            </div>

            <div style="text-align: center; margin-top: 15px; opacity: 0.8;">
                <small>Price generated by AI-powered pricing system</small>
            </div>
        </div>
    </div>
    </div>
    </div>

    <div class="footer">
        <p style="color: #666; margin: 0;">
            BrainGain Tech Innovation Solutions &copy; 2026
        </p>
        <p style="margin: 10px 0 0 0;">
            <a href="/admin/login" style="color: #E89D3C; text-decoration: none; font-size: 0.9em;">
                Admin Access
            </a>
        </p>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>